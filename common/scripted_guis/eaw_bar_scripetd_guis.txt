scripted_gui = {
	pentarchy_info_button = {
		window_name = "pentarchy_info_button_container"
		parent_window_name = "MapmodesInterface_Ingame"
		context_type = player_context
		visible = {
			tag = BAR
		}
		effects = {
			pentarchy_info_button_click = {
				if = {
					limit = {
						has_variable = bar_pen_screen_show
					}
					clear_variable = bar_pen_screen_show
					clear_variable = bar_pen_screen
				} else_if = {
					limit = {
						has_variable = bar_pen_screen
					}
					clear_variable = bar_pen_screen
				} else = {
					set_variable = {
						bar_pen_screen_show = 1
					}
					BAR_gui_reset = yes
				}
			}
		}
	}	
	viira_journal_button = {
		window_name = "viira_journal_button_container"
		parent_window_name = "MapmodesInterface_Ingame"
		context_type = player_context
		visible = {
			tag = BAR
		}
		effects = {
			viira_journal_button_click = {
				if = {
					limit = {
						has_variable = bar_viira_show_notes
					}
					clear_variable = bar_viira_show_notes
				} else = {
					set_variable = {
						bar_viira_show_notes = 1
					}
				}
			}
		}
	}	
	bar_viira_note_flavor1 = {
		window_name = "bar_viira_note_flavor1"
		context_type = player_context
		dirty = bar_viira_show_notes
		visible = {
			tag = BAR
			has_variable = bar_viira_show_notes
		}
		effects = {
			bar_viira_note_flavor1_exit_click = {
				clear_variable = bar_viira_show_notes
			}
		}
	}
	bar_viira_note_1 = {
		window_name = "bar_viira_note_1"
		context_type = player_context
		dirty = bar_viira_show_notes
		visible = {
			tag = BAR
			has_variable = bar_viira_show_notes
			has_country_flag = bar_viira_investigation_step_2
		}
	}
	bar_viira_note_2= {
		window_name = "bar_viira_note_2"
		context_type = player_context
		dirty = bar_viira_show_notes
		visible = {
			tag = BAR
			has_variable = bar_viira_show_notes
			has_country_flag = bar_viira_investigation_step_3
		}
	}
	bar_viira_note_3 = {
		window_name = "bar_viira_note_3"
		context_type = player_context
		dirty = bar_viira_show_notes
		visible = {
			tag = BAR
			has_variable = bar_viira_show_notes
			has_country_flag = bar_viira_investigation_step_4
		}
	}
	bar_viira_note_4 = {
		window_name = "bar_viira_note_4"
		context_type = player_context
		dirty = bar_viira_show_notes
		visible = {
			tag = BAR
			has_variable = bar_viira_show_notes
			has_country_flag = bar_viira_investigation_step_5
		}
	}
	bar_viira_note_5 = {
		window_name = "bar_viira_note_5"
		context_type = player_context
		dirty = bar_viira_show_notes
		visible = {
			tag = BAR
			has_variable = bar_viira_show_notes
			has_country_flag = bar_viira_investigation_step_6
		}
	}
	bar_viira_note_6 = {
		window_name = "bar_viira_note_6"
		context_type = player_context
		dirty = bar_viira_show_notes
		visible = {
			tag = BAR
			has_variable = bar_viira_show_notes
			has_country_flag = bar_viira_investigation_step_7
		}
	}
	bar_viira_note_7 = {
		window_name = "bar_viira_note_7"
		context_type = player_context
		dirty = bar_viira_show_notes
		visible = {
			tag = BAR
			has_variable = bar_viira_show_notes
			has_country_flag = bar_viira_investigation_step_8
		}
	}
	bar_viira_note_8 = {
		window_name = "bar_viira_note_8"
		context_type = player_context
		dirty = bar_viira_show_notes
		visible = {
			tag = BAR
			has_variable = bar_viira_show_notes
			has_country_flag = bar_viira_investigation_step_7
			has_country_flag = bar_viira_investigation_step_8
		}
	}
	bar_viira_note_9 = {
		window_name = "bar_viira_note_9"
		context_type = player_context
		dirty = bar_viira_show_notes
		visible = {
			tag = BAR
			has_variable = bar_viira_show_notes
			has_country_flag = bar_viira_investigation_step_9
		}
	}
	bar_viira_note_10 = {
		window_name = "bar_viira_note_10"
		context_type = player_context
		dirty = bar_viira_show_notes
		visible = {
			tag = BAR
			has_variable = bar_viira_show_notes
			has_country_flag = bar_viira_investigation_step_10
		}
	}
	bar_viira_note_11 = {
		window_name = "bar_viira_note_11"
		context_type = player_context
		dirty = bar_viira_show_notes
		visible = {
			tag = BAR
			has_variable = bar_viira_show_notes
			has_country_flag = bar_viira_investigation_step_11
		}
	}
	bar_pen_screen_ambrosius_button_container = {
		window_name = "bar_pen_screen_ambrosius_button_container"
		dirty = bar_pen_screen_show
		context_type = player_context
		visible = {
			has_variable = bar_pen_screen_show
		}
		effects = {
			bar_pen_screen_ambrosius_button_exit_click = {
				clear_variable = bar_pen_screen_show
			}
			bar_pen_screen_ambrosius_button_click = {
				clear_variable = bar_pen_screen_show
				set_variable = {
					bar_pen_screen = 1
				}
			}
		}
	}
	bar_pen_screen_asinti_button_container = {
		window_name = "bar_pen_screen_asinti_button_container"
		dirty = bar_pen_screen_show
		context_type = player_context
		visible = {
			has_variable = bar_pen_screen_show
		}
		effects = {
			bar_pen_screen_asinti_button_click = {
				clear_variable = bar_pen_screen_show
				set_variable = {
					bar_pen_screen = 2
				}
			}
		}
	}
	bar_pen_screen_leopold_button_container = {
		window_name = "bar_pen_screen_leopold_button_container"
		dirty = bar_pen_screen_show
		context_type = player_context
		visible = {
			has_variable = bar_pen_screen_show
		}
		effects = {
			bar_pen_screen_leopold_button_click = {
				clear_variable = bar_pen_screen_show
				set_variable = {
					bar_pen_screen = 3
				}
			}
		}
	}
	bar_pen_screen_silver_button_container = {
		window_name = "bar_pen_screen_silver_button_container"
		dirty = bar_pen_screen_show
		context_type = player_context
		visible = {
			has_variable = bar_pen_screen_show
		}
		effects = {
			bar_pen_screen_silver_button_click = {
				clear_variable = bar_pen_screen_show
				set_variable = {
					bar_pen_screen = 4
				}
			}
		}
	}
	bar_pen_screen_viira_button_container = {
		window_name = "bar_pen_screen_viira_button_container"
		dirty = bar_pen_screen_show
		context_type = player_context
		visible = {
			has_variable = bar_pen_screen_show
		}
		effects = {
			bar_pen_screen_viira_button_click = {
				clear_variable = bar_pen_screen_show
				set_variable = {
					bar_pen_screen = 5
				}
			}
		}
	}
	bar_pen_screen_ambrosius_info = {
		context_type = player_context
		dirty = bar_pen_screen
		window_name = "bar_pen_screen_ambrosius_info"
		visible = {
			check_variable = {
				bar_pen_screen = 1
			}
		}
		effects = {
			bar_pen_screen_ambrosius_info_portrait_clip_click = {
				clear_variable = bar_pen_screen
				set_variable = {
					bar_pen_screen_show = 1
				}
			}
		}
	}
	bar_pen_screen_asinti_info = {
		context_type = player_context
		dirty = bar_pen_screen
		window_name = "bar_pen_screen_asinti_info"
		visible = {
			check_variable = {
				bar_pen_screen = 2
			}
		}
		effects = {
			bar_pen_screen_asinti_info_portrait_clip_click = {
				clear_variable = bar_pen_screen
				set_variable = {
					bar_pen_screen_show = 1
				}
			}
		}
	}
	bar_pen_screen_leopold_info = {
		context_type = player_context
		dirty = bar_pen_screen
		window_name = "bar_pen_screen_leopold_info"
		visible = {
			check_variable = {
				bar_pen_screen = 3
			}
		}
		effects = {
			bar_pen_screen_leopold_info_portrait_clip_click = {
				clear_variable = bar_pen_screen
				set_variable = {
					bar_pen_screen_show = 1
				}
			}
		}
	}
	bar_pen_screen_silver_info = {
		context_type = player_context
		dirty = bar_pen_screen
		window_name = "bar_pen_screen_silver_info"
		visible = {
			check_variable = {
				bar_pen_screen = 4
			}
		}
		effects = {
			bar_pen_screen_silver_info_portrait_clip_click = {
				clear_variable = bar_pen_screen
				set_variable = {
					bar_pen_screen_show = 1
				}
			}
		}
	}
	bar_pen_screen_viira_info = {
		context_type = player_context
		dirty = bar_pen_screen
		window_name = "bar_pen_screen_viira_info"
		visible = {
			check_variable = {
				bar_pen_screen = 5
			}
		}
		effects = {
			bar_pen_screen_viira_info_portrait_clip_click = {
				clear_variable = bar_pen_screen
				set_variable = {
					bar_pen_screen_show = 1
				}
			}
		}
	}
	bar_new_journal_entry = {
		window_name = "bar_new_journal_entry_window"
		dirty = BAR_new_journal_entry_trigger
		context_type = player_context
		visible = {
			has_variable = BAR_new_journal_entry_trigger
			tag = BAR
		}
	}

	#######################################################################################
	#######################################################################################
	#######################################################################################
	#######################################################################################
	#######################################################################################
	#######################################################################################
	#######################################################################################
	#######################################################################################
	#######################################################################################

	bar_viira_map_overlays = {
		window_name = "bar_viira_map_overlays_container"
		parent_window_name = "MapmodesInterface_Ingame"
		context_type = player_context
		dirty = BAR_viira_godhood
		visible = {
			ROOT = {
				tag = BAR
				has_variable = BAR_viira_godhood
			}
		}
		triggers = {
			bar_viira_psi_migration_mode_button_visible = {
				has_country_flag = BAR_spells_unlocked_1
			}
		}
		effects = {
			bar_viira_nukes_button_click = {
				if = {
					limit = {
						has_country_flag = bar_viira_nuke_mode
					}
					clr_country_flag = bar_viira_nuke_mode
					play_song = "maintheme"
				} else = {
					set_country_flag = bar_viira_nuke_mode
					play_song = "loss"
				}
			}
			bar_viira_zone_button_click = {
				if = {
					limit = {
						has_country_flag = bar_viira_zone_mode
					}
					clr_country_flag = bar_viira_zone_mode
				} else = {
					set_country_flag = bar_viira_zone_mode
				}
			}
			bar_viira_x_decay_button_click = {
				if = {
					limit = {
						has_country_flag = bar_viira_x_decay_mode
					}
					clr_country_flag = bar_viira_x_decay_mode
				} else = {
					set_country_flag = bar_viira_x_decay_mode
				}
			}
			bar_viira_spell_gas_mode_button_click = {
				if = {
					limit = {
						has_country_flag = bar_viira_spell_gas_mode
					}
					clr_country_flag = bar_viira_spell_gas_mode
				} else = {
					set_country_flag = bar_viira_spell_gas_mode
				}
			}
			bar_viira_electromagnetism_mode_button_click = {
				if = {
					limit = {
						has_country_flag = bar_viira_electromagnetism_mode
					}
					clr_country_flag = bar_viira_electromagnetism_mode
				} else = {
					set_country_flag = bar_viira_electromagnetism_mode
				}
			}
			bar_viira_psi_emission_mode_button_click = {
				if = {
					limit = {
						has_country_flag = bar_viira_psi_emission_mode
					}
					clr_country_flag = bar_viira_psi_emission_mode
				} else = {
					set_country_flag = bar_viira_psi_emission_mode
				}
			}
			bar_viira_incineration_mode_button_click = {
				if = {
					limit = {
						has_country_flag = bar_viira_incineration_mode
					}
					clr_country_flag = bar_viira_incineration_mode
				} else = {
					set_country_flag = bar_viira_incineration_mode
				}
			}
			bar_viira_earthshocks_mode_button_click = {
				if = {
					limit = {
						has_country_flag = bar_viira_earthshocks_mode
					}
					clr_country_flag = bar_viira_earthshocks_mode
				} else = {
					set_country_flag = bar_viira_earthshocks_mode
				}
			}
			bar_viira_global_psi_emission_mode_button_click = {
				if = {
					limit = {
						has_country_flag = bar_viira_global_psi_emission_mode
					}
					clr_country_flag = bar_viira_global_psi_emission_mode
				} else = {
					set_country_flag = bar_viira_global_psi_emission_mode
				}
			}
			bar_viira_psi_migration_mode_button_click = {
				if = {
					limit = {
						has_country_flag = bar_viira_psi_migration_mode
					}
					clr_country_flag = bar_viira_psi_migration_mode
				} else = {
					set_country_flag = bar_viira_psi_migration_mode
				}
			}
		}
	}

	BAR_viira_spells_ui = {
		window_name = "BAR_viira_spells_ui_container"
		context_type = decision_category
		dirty = BAR_viira_godhood
		visible = {
			has_variable = BAR_viira_godhood
		}	
		triggers = {
			bar_viira_spells_upgrade_open_button_available = {
				has_variable = bar_viira_spells_upgrade_unlock
			}
		}
		effects = {
			bar_viira_spells_upgrade_open_button_click = {
				BAR_spell_upgrades_prepare = yes
				if = {
					limit = {
						has_variable = bar_viira_spells_upgrade
					}
					clear_variable = bar_viira_spells_upgrade
				} else = {
					set_variable = {
						bar_viira_spells_upgrade = 1
					}
				}
			}
		}
	}

	# @var bar_viira_mana_crystal_array array<{1-16},{1,2}> holds amount of nuclear reactors up to 16
	# each row can have two states:
	# 1 => no reactor
	# 2 => reactor
	bar_viira_spells_unlock = {
		window_name = "bar_viira_spells_unlock_container"
		context_type = player_context
		dirty = bar_viira_spells_upgrade
		visible = {
			has_variable = bar_viira_spells_upgrade
		}
		effects = {
			bar_viira_button_unlock_1_click = {
				if = {
					limit = {
						nuclear_reactor > 1
						NOT = { has_country_flag = BAR_spells_unlocked_1 }
					}
					BAR_unlock_spells_1 = yes
				}
			}
			bar_viira_button_unlock_2_click = {
				if = {
					limit = {
						nuclear_reactor > 3
						NOT = { has_country_flag = BAR_spells_unlocked_2 }
					}
					BAR_unlock_spells_2 = yes
				}
			}
			bar_viira_button_unlock_3_click = {
				if = {
					limit = {
						nuclear_reactor > 5
						NOT = { has_country_flag = BAR_spells_unlocked_3 }
					}
					BAR_unlock_spells_3 = yes
				}
			}
			bar_viira_button_unlock_4_click = {
				if = {
					limit = {
						nuclear_reactor > 7
						NOT = { has_country_flag = BAR_spells_unlocked_4 }
					}
					BAR_unlock_spells_4 = yes
				}
			}
			bar_viira_button_unlock_5_click = {
				if = {
					limit = {
						nuclear_reactor > 9
						NOT = { has_country_flag = BAR_spells_unlocked_5 }
					}
					BAR_unlock_spells_5 = yes
				}
			}
			bar_viira_button_unlock_6_click = {
				if = {
					limit = {
						nuclear_reactor > 11
						NOT = { has_country_flag = BAR_spells_unlocked_6 }
					}
					BAR_unlock_spells_6 = yes
				}
			}
			bar_viira_button_unlock_7_click = {
				if = {
					limit = {
						nuclear_reactor > 13
						NOT = { has_country_flag = BAR_spells_unlocked_7 }
					}
					BAR_unlock_spells_7 = yes
				}
			}
			bar_viira_button_unlock_8_click = {
				if = {
					limit = {
						nuclear_reactor > 15
						has_country_flag = BAR_spells_unlocked_1
						has_country_flag = BAR_spells_unlocked_2
						has_country_flag = BAR_spells_unlocked_3
						has_country_flag = BAR_spells_unlocked_4
						has_country_flag = BAR_spells_unlocked_5
						has_country_flag = BAR_spells_unlocked_6
						has_country_flag = BAR_spells_unlocked_7
						NOT = { has_country_flag = BAR_spells_unlocked_8 }
					}
					BAR_unlock_spells_8 = yes
				}
			}
		}
		properties = {
			bar_viira_mana_crystal_1 = { frame = bar_viira_mana_crystal_array^0 }
			bar_viira_mana_crystal_2 = { frame = bar_viira_mana_crystal_array^1 }
			bar_viira_mana_crystal_3 = { frame = bar_viira_mana_crystal_array^2 }
			bar_viira_mana_crystal_4 = { frame = bar_viira_mana_crystal_array^3 }
			bar_viira_mana_crystal_5 = { frame = bar_viira_mana_crystal_array^4 }
			bar_viira_mana_crystal_6 = { frame = bar_viira_mana_crystal_array^5 }
			bar_viira_mana_crystal_7 = { frame = bar_viira_mana_crystal_array^6 }
			bar_viira_mana_crystal_8 = { frame = bar_viira_mana_crystal_array^7 }
			bar_viira_mana_crystal_9 = { frame = bar_viira_mana_crystal_array^8 }
			bar_viira_mana_crystal_10 = { frame = bar_viira_mana_crystal_array^9 }
			bar_viira_mana_crystal_11 = { frame = bar_viira_mana_crystal_array^10 }
			bar_viira_mana_crystal_12 = { frame = bar_viira_mana_crystal_array^11 }
			bar_viira_mana_crystal_13 = { frame = bar_viira_mana_crystal_array^12 }
			bar_viira_mana_crystal_14 = { frame = bar_viira_mana_crystal_array^13 }
			bar_viira_mana_crystal_15 = { frame = bar_viira_mana_crystal_array^14 }
			bar_viira_mana_crystal_16 = { frame = bar_viira_mana_crystal_array^15 }
		}
	}
	
	#######################################################################################
	#######################################################################################
	#######################################################################################
	#######################################################################################
	#######################################################################################
	#######################################################################################
	#######################################################################################
	#######################################################################################
	#######################################################################################

	bar_pentarchy_fight = {
		window_name = "bar_pentarchy_fight_window"
		dirty = bar_pentarchy_fight_show
		context_type = player_context
		visible = {
			has_variable = bar_pentarchy_fight_show
			tag = BAR
		}
		effects = {
			fight_rest_button_click = {
				BAR_pen_fight_rest = yes
			}
		}
		triggers = {
			bar_pen_fight_stun_log_visible = {
				has_variable = v_stun_turn
			}
		}
	}
	
	bar_pentarchy_fight_viira = {
		window_name = "bar_pentarchy_fight_viira"
		parent_window_name = "bar_pentarchy_fight_window"
		dirty = bar_pentarchy_fight_show
		context_type = player_context

		triggers = {
			bar_viira_heal_click_enabled = {
				has_country_flag = bar_fight_viira_side
				has_country_flag = barrad_viira_alive
				check_variable = {
					v_stun < 1
				}
				check_variable = {
					v_in > 0
				}
				check_variable = {
					BAR_resources_viira > 199
				}
			}
			bar_viira_strong_attack_click_enabled = {
				has_country_flag = bar_fight_viira_side
				has_country_flag = barrad_viira_alive
				check_variable = {
					v_stun < 1
				}
				check_variable = {
					v_in > 2
				}
				check_variable = {
					BAR_resources_viira > 99
				}
			}
			bar_viira_normal_attack_click_enabled = {
				has_country_flag = bar_fight_viira_side
				has_country_flag = barrad_viira_alive
				check_variable = {
					v_stun < 1
				}
				check_variable = {
					v_in > 0
				}
			}
		}

		effects = {
			bar_viira_heal_click = {
				bar_viira_fight_heal = yes
			}
			bar_viira_strong_attack_click = {
				bar_viira_fight_strong_attack = yes
			}
			bar_viira_normal_attack_click = {
				bar_viira_fight_normal_attack = yes
			}
		}
		properties = {			
			bar_pen_fight_viira_hp_10 = { frame = bar_fight_viira_hp_bar^0 }
			bar_pen_fight_viira_hp_20 = { frame = bar_fight_viira_hp_bar^1 }
			bar_pen_fight_viira_hp_30 = { frame = bar_fight_viira_hp_bar^2 }
			bar_pen_fight_viira_hp_40 = { frame = bar_fight_viira_hp_bar^3 }
			bar_pen_fight_viira_hp_50 = { frame = bar_fight_viira_hp_bar^4 }
			bar_pen_fight_viira_hp_60 = { frame = bar_fight_viira_hp_bar^5 }
			bar_pen_fight_viira_hp_70 = { frame = bar_fight_viira_hp_bar^6 }
			bar_pen_fight_viira_hp_80 = { frame = bar_fight_viira_hp_bar^7 }
			bar_pen_fight_viira_hp_90 = { frame = bar_fight_viira_hp_bar^8 }
			bar_pen_fight_viira_hp_100 = { frame = bar_fight_viira_hp_bar^9 }
			bar_pen_fight_viira_hp_110 = { frame = bar_fight_viira_hp_bar^10 }
			bar_pen_fight_viira_hp_120 = { frame = bar_fight_viira_hp_bar^11 }
			bar_pen_fight_viira_hp_130 = { frame = bar_fight_viira_hp_bar^12 }
			bar_pen_fight_viira_hp_140 = { frame = bar_fight_viira_hp_bar^13 }
			bar_pen_fight_viira_hp_150 = { frame = bar_fight_viira_hp_bar^14 }
			bar_pen_fight_viira_hp_160 = { frame = bar_fight_viira_hp_bar^15 }
			bar_pen_fight_viira_hp_170 = { frame = bar_fight_viira_hp_bar^16 }
			bar_pen_fight_viira_hp_180 = { frame = bar_fight_viira_hp_bar^17 }
			bar_pen_fight_viira_hp_190 = { frame = bar_fight_viira_hp_bar^18 }
			bar_pen_fight_viira_hp_200 = { frame = bar_fight_viira_hp_bar^19 }
			bar_pen_fight_viira_hp_210 = { frame = bar_fight_viira_hp_bar^20 }
			bar_pen_fight_viira_hp_220 = { frame = bar_fight_viira_hp_bar^21 }
			bar_pen_fight_viira_hp_230 = { frame = bar_fight_viira_hp_bar^22 }
			bar_pen_fight_viira_hp_240 = { frame = bar_fight_viira_hp_bar^23 }
			bar_pen_fight_viira_hp_250 = { frame = bar_fight_viira_hp_bar^24 }
			bar_pen_fight_viira_hp_260 = { frame = bar_fight_viira_hp_bar^25 }
			bar_pen_fight_viira_hp_270 = { frame = bar_fight_viira_hp_bar^26 }
			bar_pen_fight_viira_hp_280 = { frame = bar_fight_viira_hp_bar^27 }

			bar_pen_fight_viira_in_1 = { frame = bar_fight_viira_initiative_bar^0 }
			bar_pen_fight_viira_in_2 = { frame = bar_fight_viira_initiative_bar^1 }
			bar_pen_fight_viira_in_3 = { frame = bar_fight_viira_initiative_bar^2 }
			bar_pen_fight_viira_in_4 = { frame = bar_fight_viira_initiative_bar^3 }
			bar_pen_fight_viira_in_5 = { frame = bar_fight_viira_initiative_bar^4 }
			bar_pen_fight_viira_in_6 = { frame = bar_fight_viira_initiative_bar^5 }
			bar_pen_fight_viira_in_7 = { frame = bar_fight_viira_initiative_bar^6 }
			bar_pen_fight_viira_in_8 = { frame = bar_fight_viira_initiative_bar^7 }
			bar_pen_fight_viira_in_9 = { frame = bar_fight_viira_initiative_bar^8 }
			bar_pen_fight_viira_in_10 = { frame = bar_fight_viira_initiative_bar^9 }
			bar_pen_fight_viira_in_11 = { frame = bar_fight_viira_initiative_bar^10 }
			bar_pen_fight_viira_in_12 = { frame = bar_fight_viira_initiative_bar^11 }
			bar_pen_fight_viira_in_13 = { frame = bar_fight_viira_initiative_bar^12 }
			bar_pen_fight_viira_in_14 = { frame = bar_fight_viira_initiative_bar^13 }
			bar_pen_fight_viira_in_15 = { frame = bar_fight_viira_initiative_bar^14 }
			bar_pen_fight_viira_in_16 = { frame = bar_fight_viira_initiative_bar^15 }
			bar_pen_fight_viira_in_17 = { frame = bar_fight_viira_initiative_bar^16 }
			bar_pen_fight_viira_in_18 = { frame = bar_fight_viira_initiative_bar^17 }
			bar_pen_fight_viira_in_19 = { frame = bar_fight_viira_initiative_bar^18 }
			bar_pen_fight_viira_in_20 = { frame = bar_fight_viira_initiative_bar^19 }
		}
	}

	bar_pentarchy_fight_leopold = {
		window_name = "bar_pentarchy_fight_leopold_window"
		parent_window_name = "bar_pentarchy_fight_window"
		dirty = bar_pentarchy_fight_show
		context_type = player_context
		visible = {
			has_variable = bar_pentarchy_fight_show
			has_variable = bar_pen_fight_leopold_alive_at_start
			tag = BAR
		}
		triggers = {
			bar_pen_fight_leopold_portrait_click_enabled = {
				has_country_flag = barrad_leopold_alive
			}
			bar_leopold_normal_attack_click_enabled = {
				has_country_flag = barrad_leopold_alive
				check_variable = {
					l_in > 0
				}
			}
			bar_leopold_strong_attack_click_enabled = {
				has_country_flag = barrad_leopold_alive
				check_variable = {
					l_in > 2
				}
				check_variable = {
					BAR_resources_leopold > 49
				}
			}
			bar_leopold_stun_attack_click_enabled = {
				has_country_flag = barrad_leopold_alive
				check_variable = {
					v_stun = 0
				}
				check_variable = {
					l_in > 1
				}
				check_variable = {
					BAR_resources_leopold > 99
				}
			}
		}
		effects = {
			bar_pen_fight_leopold_portrait_click = {
				bar_viira_fight_deal_dmg_leopold = yes
				BAR_silver_heal_leopold = yes
			}
			bar_leopold_normal_attack_click = {
				BAR_pen_fight_leopold_normal_attack = yes
			}
			bar_leopold_strong_attack_click = {
				BAR_pen_fight_leopold_strong_attack = yes
			}
			bar_leopold_stun_attack_click = {
				BAR_pen_fight_leopold_stun = yes
			}
		}
		properties = {
			bar_pen_fight_leopold_hp_10 = { frame = bar_fight_leopold_hp_bar^0 }
			bar_pen_fight_leopold_hp_20 = { frame = bar_fight_leopold_hp_bar^1 }
			bar_pen_fight_leopold_hp_30 = { frame = bar_fight_leopold_hp_bar^2 }
			bar_pen_fight_leopold_hp_40 = { frame = bar_fight_leopold_hp_bar^3 }
			bar_pen_fight_leopold_hp_50 = { frame = bar_fight_leopold_hp_bar^4 }
			bar_pen_fight_leopold_hp_60 = { frame = bar_fight_leopold_hp_bar^5 }
			bar_pen_fight_leopold_hp_70 = { frame = bar_fight_leopold_hp_bar^6 }
			bar_pen_fight_leopold_hp_80 = { frame = bar_fight_leopold_hp_bar^7 }
			bar_pen_fight_leopold_hp_90 = { frame = bar_fight_leopold_hp_bar^8 }
			bar_pen_fight_leopold_hp_100 = { frame = bar_fight_leopold_hp_bar^9 }
			bar_pen_fight_leopold_hp_110 = { frame = bar_fight_leopold_hp_bar^10 }
			bar_pen_fight_leopold_hp_120 = { frame = bar_fight_leopold_hp_bar^11 }
			bar_pen_fight_leopold_hp_130 = { frame = bar_fight_leopold_hp_bar^12 }
			bar_pen_fight_leopold_hp_140 = { frame = bar_fight_leopold_hp_bar^13 }
			bar_pen_fight_leopold_hp_150 = { frame = bar_fight_leopold_hp_bar^14 }
			bar_pen_fight_leopold_hp_160 = { frame = bar_fight_leopold_hp_bar^15 }
			bar_pen_fight_leopold_hp_170 = { frame = bar_fight_leopold_hp_bar^16 }
			bar_pen_fight_leopold_hp_180 = { frame = bar_fight_leopold_hp_bar^17 }
			bar_pen_fight_leopold_hp_190 = { frame = bar_fight_leopold_hp_bar^18 }
			bar_pen_fight_leopold_hp_200 = { frame = bar_fight_leopold_hp_bar^19 }
			bar_pen_fight_leopold_hp_210 = { frame = bar_fight_leopold_hp_bar^20 }
			bar_pen_fight_leopold_hp_220 = { frame = bar_fight_leopold_hp_bar^21 }

			bar_pen_fight_leopold_in_1 = { frame = bar_fight_leopold_initiative_bar^0 }
			bar_pen_fight_leopold_in_2 = { frame = bar_fight_leopold_initiative_bar^1 }
			bar_pen_fight_leopold_in_3 = { frame = bar_fight_leopold_initiative_bar^2 }
			bar_pen_fight_leopold_in_4 = { frame = bar_fight_leopold_initiative_bar^3 }
			bar_pen_fight_leopold_in_5 = { frame = bar_fight_leopold_initiative_bar^4 }
			bar_pen_fight_leopold_in_6 = { frame = bar_fight_leopold_initiative_bar^5 }
			bar_pen_fight_leopold_in_7 = { frame = bar_fight_leopold_initiative_bar^6 }
			bar_pen_fight_leopold_in_8 = { frame = bar_fight_leopold_initiative_bar^7 }
			bar_pen_fight_leopold_in_9 = { frame = bar_fight_leopold_initiative_bar^8 }
			bar_pen_fight_leopold_in_10 = { frame = bar_fight_leopold_initiative_bar^9 }
		}
	}
	bar_pentarchy_fight_asinti = {
		window_name = "bar_pentarchy_fight_asinti_window"
		parent_window_name = "bar_pentarchy_fight_window"
		dirty = bar_pentarchy_fight_show
		context_type = player_context
		visible = {
			has_variable = bar_pentarchy_fight_show
			has_variable = bar_pen_fight_asinti_alive_at_start
			tag = BAR
		}
		triggers = {
			bar_pen_fight_asinti_portrait_click_enabled = {
				has_country_flag = barrad_asinti_alive
			}
			bar_asinti_normal_attack_click_enabled = {
				has_country_flag = barrad_asinti_alive
				check_variable = {
					a_in > 0
				}
			}
			bar_asinti_curse_click_enabled = {
				has_country_flag = barrad_asinti_alive
				check_variable = {
					a_in > 1
				}
				check_variable = {
					BAR_resources_asinti > 49
				}
			}
			bar_asinti_party_heal_click_enabled = {
				has_country_flag = barrad_asinti_alive
				check_variable = {
					a_in > 1
				}
				check_variable = {
					BAR_resources_asinti > 99
				}
			}
		}
		effects = {
			bar_pen_fight_asinti_portrait_click = {
				bar_viira_fight_deal_dmg_asinti = yes
				BAR_silver_heal_asinti = yes
			}
			bar_asinti_normal_attack_click = {
				BAR_pen_fight_asinti_normal_attack = yes
			}
			bar_asinti_curse_click = {
				BAR_pen_fight_asinti_debuf = yes
			}
			bar_asinti_party_heal_click = {
				BAR_pen_fight_asinti_heal = yes
			}
		}
		properties = {			
			bar_pen_fight_asinti_hp_10 = { frame = bar_fight_asinti_hp_bar^0 }
			bar_pen_fight_asinti_hp_20 = { frame = bar_fight_asinti_hp_bar^1 }
			bar_pen_fight_asinti_hp_30 = { frame = bar_fight_asinti_hp_bar^2 }
			bar_pen_fight_asinti_hp_40 = { frame = bar_fight_asinti_hp_bar^3 }
			bar_pen_fight_asinti_hp_50 = { frame = bar_fight_asinti_hp_bar^4 }
			bar_pen_fight_asinti_hp_60 = { frame = bar_fight_asinti_hp_bar^5 }
			bar_pen_fight_asinti_hp_70 = { frame = bar_fight_asinti_hp_bar^6 }
			bar_pen_fight_asinti_hp_80 = { frame = bar_fight_asinti_hp_bar^7 }
			bar_pen_fight_asinti_hp_90 = { frame = bar_fight_asinti_hp_bar^8 }
			bar_pen_fight_asinti_hp_100 = { frame = bar_fight_asinti_hp_bar^9 }
			bar_pen_fight_asinti_hp_110 = { frame = bar_fight_asinti_hp_bar^10 }
			bar_pen_fight_asinti_hp_120 = { frame = bar_fight_asinti_hp_bar^11 }
			bar_pen_fight_asinti_hp_130 = { frame = bar_fight_asinti_hp_bar^12 }
			bar_pen_fight_asinti_hp_140 = { frame = bar_fight_asinti_hp_bar^13 }
			bar_pen_fight_asinti_hp_150 = { frame = bar_fight_asinti_hp_bar^14 }
			bar_pen_fight_asinti_hp_160 = { frame = bar_fight_asinti_hp_bar^15 }
			bar_pen_fight_asinti_hp_170 = { frame = bar_fight_asinti_hp_bar^16 }
			bar_pen_fight_asinti_hp_180 = { frame = bar_fight_asinti_hp_bar^17 }
			bar_pen_fight_asinti_hp_190 = { frame = bar_fight_asinti_hp_bar^18 }

			bar_pen_fight_asinti_in_1 = { frame = bar_fight_asinti_initiative_bar^0 }
			bar_pen_fight_asinti_in_2 = { frame = bar_fight_asinti_initiative_bar^1 }
			bar_pen_fight_asinti_in_3 = { frame = bar_fight_asinti_initiative_bar^2 }
			bar_pen_fight_asinti_in_4 = { frame = bar_fight_asinti_initiative_bar^3 }
			bar_pen_fight_asinti_in_5 = { frame = bar_fight_asinti_initiative_bar^4 }
			bar_pen_fight_asinti_in_6 = { frame = bar_fight_asinti_initiative_bar^5 }
			bar_pen_fight_asinti_in_7 = { frame = bar_fight_asinti_initiative_bar^6 }
			bar_pen_fight_asinti_in_8 = { frame = bar_fight_asinti_initiative_bar^7 }
			bar_pen_fight_asinti_in_9 = { frame = bar_fight_asinti_initiative_bar^8 }
			bar_pen_fight_asinti_in_10 = { frame = bar_fight_asinti_initiative_bar^9 }
		}
	}

	bar_pentarchy_fight_silver = {
		window_name = "bar_pentarchy_fight_silver_window"
		parent_window_name = "bar_pentarchy_fight_window"
		dirty = bar_pentarchy_fight_show
		context_type = player_context
		visible = {
			has_variable = bar_pentarchy_fight_show
			has_variable = bar_pen_fight_silver_alive_at_start
			tag = BAR
		}
		triggers = {
			bar_pen_fight_silver_portrait_click_enabled = {
				has_country_flag = barrad_silver_star_alive
			}
			bar_silver_normal_attack_click_enabled = {
				has_country_flag = barrad_silver_star_alive
				check_variable = {
					s_in > 0
				}
			}
			bar_silver_lifesteal_attack_click_enabled = {
				has_country_flag = barrad_silver_star_alive
				check_variable = {
					s_in > 1
				}
				check_variable = {
					BAR_resources_silver > 49
				}
			}
			bar_silver_heal_click_enabled = {
				has_country_flag = barrad_silver_star_alive
				check_variable = {
					s_in > 1
				}
				check_variable = {
					BAR_resources_silver > 99
				}
			}
		}
		effects = {
			bar_pen_fight_silver_portrait_click = {
				bar_viira_fight_deal_dmg_silver = yes
				BAR_silver_heal_silver = yes
			}
			bar_silver_normal_attack_click = {
				BAR_pen_fight_silver_normal_attack = yes
			}
			bar_silver_lifesteal_attack_click = {
				BAR_pen_fight_silver_lifesteal_attack = yes
			}
			bar_silver_heal_click = {
				BAR_silver_heal = yes
			}
		}
		properties = {
			bar_pen_fight_silver_star_hp_10 = { frame = bar_fight_silver_star_hp_bar^0 }
			bar_pen_fight_silver_star_hp_20 = { frame = bar_fight_silver_star_hp_bar^1 }
			bar_pen_fight_silver_star_hp_30 = { frame = bar_fight_silver_star_hp_bar^2 }
			bar_pen_fight_silver_star_hp_40 = { frame = bar_fight_silver_star_hp_bar^3 }
			bar_pen_fight_silver_star_hp_50 = { frame = bar_fight_silver_star_hp_bar^4 }
			bar_pen_fight_silver_star_hp_60 = { frame = bar_fight_silver_star_hp_bar^5 }
			bar_pen_fight_silver_star_hp_70 = { frame = bar_fight_silver_star_hp_bar^6 }
			bar_pen_fight_silver_star_hp_80 = { frame = bar_fight_silver_star_hp_bar^7 }
			bar_pen_fight_silver_star_hp_90 = { frame = bar_fight_silver_star_hp_bar^8 }
			bar_pen_fight_silver_star_hp_100 = { frame = bar_fight_silver_star_hp_bar^9 }
			bar_pen_fight_silver_star_hp_110 = { frame = bar_fight_silver_star_hp_bar^10 }
			bar_pen_fight_silver_star_hp_120 = { frame = bar_fight_silver_star_hp_bar^11 }
			bar_pen_fight_silver_star_hp_130 = { frame = bar_fight_silver_star_hp_bar^12 }
			bar_pen_fight_silver_star_hp_140 = { frame = bar_fight_silver_star_hp_bar^13 }
			bar_pen_fight_silver_star_hp_150 = { frame = bar_fight_silver_star_hp_bar^14 }
			bar_pen_fight_silver_star_hp_160 = { frame = bar_fight_silver_star_hp_bar^15 }
			bar_pen_fight_silver_star_hp_170 = { frame = bar_fight_silver_star_hp_bar^16 }

			bar_pen_fight_silver_star_in_1 = { frame = bar_fight_silver_star_initiative_bar^0 }
			bar_pen_fight_silver_star_in_2 = { frame = bar_fight_silver_star_initiative_bar^1 }
			bar_pen_fight_silver_star_in_3 = { frame = bar_fight_silver_star_initiative_bar^2 }
			bar_pen_fight_silver_star_in_4 = { frame = bar_fight_silver_star_initiative_bar^3 }
			bar_pen_fight_silver_star_in_5 = { frame = bar_fight_silver_star_initiative_bar^4 }
			bar_pen_fight_silver_star_in_6 = { frame = bar_fight_silver_star_initiative_bar^5 }
			bar_pen_fight_silver_star_in_7 = { frame = bar_fight_silver_star_initiative_bar^6 }
			bar_pen_fight_silver_star_in_8 = { frame = bar_fight_silver_star_initiative_bar^7 }
			bar_pen_fight_silver_star_in_9 = { frame = bar_fight_silver_star_initiative_bar^8 }
			bar_pen_fight_silver_star_in_10 = { frame = bar_fight_silver_star_initiative_bar^9 }
		}
	}

	###############################################
	###############################################
	###############################################
	###############################################
	###############################################
	###############################################
	###############################################
	###############################################
	###############################################
	###############################################
	###############################################
	###############################################
	###############################################
	###############################################
	###############################################
	###############################################
	###############################################
	###############################################

	# @var bar_expedition_members array<> possible values:
	# 1 => gÄ…sienica
	# 2 => silver star
	# 3 => leopold
	# 4 => asinti
	# 5 => viira
	#
	# @var bar_expedition_equipment_level int in range 1-5
	#
	# @var bar_expedition_length int in range 1-10
	# each number represents number of weeks the expedition takes
	bar_expedition_container = {
		window_name = "bar_expedition_container"
		context_type = player_context
		visible = {
			tag = BAR
		}
		effects = {
			bar_expedition_members_captain_gasienica_click = {
				if = {
					limit = {
						is_in_array = { 
							array = bar_expedition_members
							value = 1 
						}
					}
					remove_from_array = {
						array = bar_expedition_members
						value = 1 
					}
				} else = {
					add_to_array = {
						array = bar_expedition_members
						value = 1 
					}
				}
			}			
			bar_expedition_members_silver_star_click = {
				if = {
					limit = {
						is_in_array = { 
							array = bar_expedition_members
							value = 2 
						}
					}
					remove_from_array = {
						array = bar_expedition_members
						value = 2 
					}
				} else = {
					add_to_array = {
						array = bar_expedition_members
						value = 2
					}
				}
			}		
			bar_expedition_members_leopold_click = {
				if = {
					limit = {
						is_in_array = { 
							array = bar_expedition_members
							value = 3 
						}
					}
					remove_from_array = {
						array = bar_expedition_members
						value = 3
					}
				} else = {
					add_to_array = {
						array = bar_expedition_members
						value = 3 
					}
				}
			}		
			bar_expedition_members_asinti_click = {
				if = {
					limit = {
						is_in_array = { 
							array = bar_expedition_members
							value = 4
						}
					}
					remove_from_array = {
						array = bar_expedition_members
						value = 4
					}
				} else = {
					add_to_array = {
						array = bar_expedition_members
						value = 4 
					}
				}
			}		
			bar_expedition_members_viira_click = {
				if = {
					limit = {
						is_in_array = { 
							array = bar_expedition_members
							value = 5 
						}
					}
					remove_from_array = {
						array = bar_expedition_members
						value = 5
					}
				} else = {
					add_to_array = {
						array = bar_expedition_members
						value = 5 
					}
				}
			}	
			bar_expedition_additional_equipment_lvl_1_click = {
				set_variable = {
					bar_expedition_equipment_level = 1
				} 
			}
			bar_expedition_additional_equipment_lvl_2_click = {
				set_variable = {
					bar_expedition_equipment_level = 2
				} 
			}
			bar_expedition_additional_equipment_lvl_3_click = {
				set_variable = {
					bar_expedition_equipment_level = 3
				} 
			}
			bar_expedition_additional_equipment_lvl_4_click = {
				set_variable = {
					bar_expedition_equipment_level = 4
				} 
			}
			bar_expedition_additional_equipment_lvl_5_click = {
				set_variable = {
					bar_expedition_equipment_level = 5
				} 
			}
			bar_expedition_length_increase_click = {
				if = {
					limit = {
						check_variable = {
							bar_expedition_length < 10
						}
					}
					add_to_variable = {
						bar_expedition_length = 1
					}
				}
			}
			bar_expedition_length_decrease_click = {
				if = {
					limit = {
						check_variable = {
							bar_expedition_length > 1
						}
					}
					subtract_from_variable = {
						bar_expedition_length = 1
					}
				}
			}
			bar_expedition_ready_click = {
				bar_expedition_calculate = yes
			}
			bar_expedition_cancel_click = {
				bar_expedition_canecel = yes
			}
			bar_expedition_launch_click = {
				bar_expedition_launch = yes
			}
			bar_expedition_select_target_click = {
				set_variable = { bar_expedition_target_tag = bar_expedition_selected_tag }
			}
		}
		dynamic_lists = {
			bar_expedition_controls_targets_list = {
				array = neighbors
				entry_container = "bar_expedition_targets"
				value = bar_expedition_selected_tag
			}
		}
	}	
}
