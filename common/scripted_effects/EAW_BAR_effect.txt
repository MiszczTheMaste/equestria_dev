BAR_pentarchy_is_dead = {
	if = {
		limit = {
			NOT = {
				has_country_flag = barrad_asinti_alive
				has_country_flag = barrad_silver_star_alive
				has_country_flag = barrad_leopold_alive
				has_country_flag = barrad_viira_alive
			}
			has_country_flag = barrad_early_game
		}
		BAR_add_gasienica_as_commander = yes
		custom_effect_tooltip = cpt_gasienica_stats_tp
		clr_country_flag = barrad_early_game
		country_event = { days = 1 id = barrad_end.1 }
	}
}
BAR_happy_ending = {
	hidden_effect = {
		if = {
			limit = {
				has_country_flag = barrad_asinti_alive
				has_country_flag = barrad_silver_star_alive
				has_country_flag = barrad_leopold_alive
				has_country_flag = barrad_viira_alive
				has_country_flag = barrad_early_game
				check_variable = {
					var = BAR_relations_asinti_silver
					value = 70
					compare = greater_than_or_equals
				}
				check_variable = {
					var = BAR_relations_asinti_viira
					value = 70
					compare = greater_than_or_equals
				}
				check_variable = {
					var = BAR_relations_silver_leopold
					value = 70
					compare = greater_than_or_equals
				}
				check_variable = {
					var = BAR_relations_silver_viira
					value = 70
					compare = greater_than_or_equals
				}
				check_variable = {
					var = BAR_relations_leopold_viira
					value = 70
					compare = greater_than_or_equals
				}
				check_variable = {
					var = BAR_relations_asinti_leopold
					value = 70
					compare = greater_than_or_equals
				}
			}
			country_event = { days = 1 id = barrad_end.2 }
		}
	}
}
BAR_relations_idea_swap = {
	hidden_effect = {
		if = {
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_asinti_silver
					value = 70
					compare = greater_than_or_equals
				}
				has_country_flag = barrad_silver_star_alive
				has_country_flag = barrad_asinti_alive
			}	
			if = {
				limit = {
					NOT = { has_idea = BAR_relations_asinti_silver_positive }
				}
				add_ideas = BAR_relations_asinti_silver_positive
			}
		}
		if = {
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_asinti_silver
					value = 30
					compare = less_than_or_equals
				}
				has_country_flag = barrad_silver_star_alive
				has_country_flag = barrad_asinti_alive
			}
			if = {
				limit = {
					NOT = { has_idea = BAR_relations_asinti_silver_negative }
				}
				add_ideas = BAR_relations_asinti_silver_negative
			}
		}
		if = {
			limit = {
				check_variable = {
					var = BAR_relations_asinti_leopold
					value = 70
					compare = greater_than_or_equals
				}
				has_country_flag = barrad_leopold_alive
				has_country_flag = barrad_asinti_alive
			}
			if = {
				limit = {
					NOT = { has_idea = BAR_relations_asinti_leopold_positive }
				}
				add_ideas = BAR_relations_asinti_leopold_positive
			}
		}
		if = {
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_asinti_leopold
					value = 30
					compare = less_than_or_equals
				}
				has_country_flag = barrad_leopold_alive
				has_country_flag = barrad_asinti_alive
			}
			if = {
				limit = {
					NOT = { has_idea = BAR_relations_asinti_leopold_negative }
				}
				add_ideas = BAR_relations_asinti_leopold_negative
			}
		}
		if = {
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_asinti_viira
					value = 70
					compare = greater_than_or_equals
				}
				has_country_flag = barrad_viira_alive
				has_country_flag = barrad_asinti_alive
			}
			if = {
				limit = {
					NOT = { has_idea = BAR_relations_asinti_viira_positive }
				}
				add_ideas = BAR_relations_asinti_viira_positive
			}
		}
		if = {
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_asinti_viira
					value = 30
					compare = less_than_or_equals
				}
				has_country_flag = barrad_viira_alive
				has_country_flag = barrad_asinti_alive
			}
			if = {
				limit = {
					NOT = { has_idea = BAR_relations_asinti_viira_negative }
				}
				add_ideas = BAR_relations_asinti_viira_negative
			}
		}
		if = {
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_silver_leopold
					value = 70
					compare = greater_than_or_equals
				}
				has_country_flag = barrad_leopold_alive
				has_country_flag = barrad_silver_star_alive
			}
			if = {
				limit = {
					NOT = { has_idea = BAR_relations_silver_leopold_positive }
				}
				add_ideas = BAR_relations_silver_leopold_positive
			}
		}
		if = {
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_silver_leopold
					value = 30
					compare = less_than_or_equals
				}
				has_country_flag = barrad_leopold_alive
				has_country_flag = barrad_silver_star_alive
			}
			if = {
				limit = {
					NOT = { has_idea = BAR_relations_silver_leopold_negative }
				}
				add_ideas = BAR_relations_silver_leopold_negative
			}
		}
		if = {
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_silver_viira
					value = 70
					compare = greater_than_or_equals
				}
				has_country_flag = barrad_viira_alive
				has_country_flag = barrad_silver_star_alive
			}
			if = {
				limit = {
					NOT = { has_idea = BAR_relations_silver_viira_positive }
				}
				add_ideas = BAR_relations_silver_viira_positive
			}
		}
		if = {
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_silver_viira
					value = 30
					compare = less_than_or_equals
				}
				has_country_flag = barrad_viira_alive
				has_country_flag = barrad_silver_star_alive
			}
			if = {
				limit = {
					NOT = { has_idea = BAR_relations_silver_viira_negative }
				}
				add_ideas = BAR_relations_silver_viira_negative
			}
		}
		if = {
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_leopold_viira
					value = 70
					compare = greater_than_or_equals
				}
				has_country_flag = barrad_viira_alive
				has_country_flag = barrad_leopold_alive
			}
			if = {
				limit = {
					NOT = { has_idea = BAR_relations_leopold_viira_positive }
				}
				add_ideas = BAR_relations_leopold_viira_positive
			}
		}
		if = {
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_leopold_viira
					value = 30
					compare = less_than_or_equals
				}
				has_country_flag = barrad_viira_alive
				has_country_flag = barrad_leopold_alive
			}
			if = {
				limit = {
					NOT = { has_idea = BAR_relations_leopold_viira_negative }
				}
				add_ideas = BAR_relations_leopold_viira_negative
			}
		}
		if = { #remove both
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_asinti_silver
					value = 30
					compare = greater_than
				}
				check_variable = {
					var = BAR_relations_asinti_silver
					value = 70
					compare = less_than
				}
			}
			if = {
				limit = {
					has_idea = BAR_relations_asinti_silver_positive
				}
				remove_ideas = BAR_relations_asinti_silver_positive
			}
			if = {
				limit = {
					has_idea = BAR_relations_asinti_silver_negative
				}
				remove_ideas = BAR_relations_asinti_silver_negative
			}
		}
		if = { #remove both
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_asinti_leopold
					value = 30
					compare = greater_than
				}
				check_variable = {
					var = BAR_relations_asinti_leopold
					value = 70
					compare = less_than
				}
			}
			if = {
				limit = {
					has_idea = BAR_relations_asinti_leopold_positive
				}
				remove_ideas = BAR_relations_asinti_leopold_positive
			}
			if = {
				limit = {
					has_idea = BAR_relations_asinti_leopold_negative
				}
				remove_ideas = BAR_relations_asinti_leopold_negative
			}
		}
		if = { #remove both
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_asinti_viira
					value = 30
					compare = greater_than
				}
				check_variable = {
					var = BAR_relations_asinti_viira
					value = 70
					compare = less_than
				}
			}
			if = {
				limit = {
					has_idea = BAR_relations_asinti_viira_positive
				}
				remove_ideas = BAR_relations_asinti_viira_positive
			}
			if = {
				limit = {
					has_idea = BAR_relations_asinti_viira_negative
				}
				remove_ideas = BAR_relations_asinti_viira_negative
			}
		}
		if = { #remove both
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_silver_leopold
					value = 30
					compare = greater_than
				}
				check_variable = {
					var = BAR_relations_silver_leopold
					value = 70
					compare = less_than
				}
				has_country_flag = barrad_silver_star_alive
			}
			if = {
				limit = {
					has_idea = BAR_relations_silver_leopold_positive
				}
				remove_ideas = BAR_relations_silver_leopold_positive
			}
			if = {
				limit = {
					has_idea = BAR_relations_silver_leopold_negative
				}
				remove_ideas = BAR_relations_silver_leopold_negative
			}
		}
		if = { #remove both
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_silver_viira
					value = 30
					compare = greater_than
				}
				check_variable = {
					var = BAR_relations_silver_viira
					value = 70
					compare = less_than
				}
			}
			if = {
				limit = {
					has_idea = BAR_relations_silver_viira_positive
				}
				remove_ideas = BAR_relations_silver_viira_positive
			}
			if = {
				limit = {
					has_idea = BAR_relations_silver_viira_negative
				}
				remove_ideas = BAR_relations_silver_viira_negative
			}
		}
		if = { #remove both
			limit = {
				tag = BAR
				check_variable = {
					var = BAR_relations_leopold_viira
					value = 30
					compare = greater_than
				}
				check_variable = {
					var = BAR_relations_leopold_viira
					value = 70
					compare = less_than
				}
			}
			if = {
				limit = {
					has_idea = BAR_relations_leopold_viira_positive
				}
				remove_ideas = BAR_relations_leopold_viira_positive
			}
			if = {
				limit = {
					has_idea = BAR_relations_leopold_viira_negative
				}
				remove_ideas = BAR_relations_leopold_viira_negative
			}
		}
	BAR_happy_ending = yes
	}
}
BAR_resources_add_asinti_100 = {
	custom_effect_tooltip = BAR_resources_gain_asinti_100
	add_to_variable = {
		var = BAR_resources_asinti
		value = 100
	}
}
BAR_resources_add_asinti_250 = {
	custom_effect_tooltip = BAR_resources_gain_asinti_250
	add_to_variable = {
		var = BAR_resources_asinti
		value = 250
	}
}
BAR_resources_add_asinti_500 = {
	custom_effect_tooltip = BAR_resources_gain_asinti_500
	add_to_variable = {
		var = BAR_resources_asinti
		value = 500
	}
}
BAR_resources_add_asinti_750 = {
	custom_effect_tooltip = BAR_resources_gain_asinti_750
	add_to_variable = {
		var = BAR_resources_asinti
		value = 750
	}
}
BAR_resources_add_asinti_1000 = {
	custom_effect_tooltip = BAR_resources_gain_asinti_1000
	add_to_variable = {
		var = BAR_resources_asinti
		value = 1000
	}
}
BAR_resources_add_silver_100 = {
	custom_effect_tooltip = BAR_resources_gain_silver_100
	add_to_variable = {
		var = BAR_resources_silver
		value = 100
	}
}
BAR_resources_add_silver_250 = {
	custom_effect_tooltip = BAR_resources_gain_silver_250
	add_to_variable = {
		var = BAR_resources_silver
		value = 250
	}
}
BAR_resources_add_silver_500 = {
	custom_effect_tooltip = BAR_resources_gain_silver_500
	add_to_variable = {
		var = BAR_resources_silver
		value = 500
	}
}
BAR_resources_add_silver_750 = {
	custom_effect_tooltip = BAR_resources_gain_silver_750
	add_to_variable = {
		var = BAR_resources_silver
		value = 750
	}
}
BAR_resources_add_silver_1000 = {
	custom_effect_tooltip = BAR_resources_gain_silver_1000
	add_to_variable = {
		var = BAR_resources_silver
		value = 1000
	}
}
BAR_resources_add_leopold_250 = {
	custom_effect_tooltip = BAR_resources_gain_leopold_250
	add_to_variable = {
		var = BAR_resources_leopold
		value = 250
	}
}
BAR_resources_add_leopold_500 = {
	custom_effect_tooltip = BAR_resources_gain_leopold_500
	add_to_variable = {
		var = BAR_resources_leopold
		value = 500
	}
}
BAR_resources_add_leopold_750 = {
	custom_effect_tooltip = BAR_resources_gain_leopold_750
	add_to_variable = {
		var = BAR_resources_leopold
		value = 750
	}
}
BAR_resources_add_leopold_1000 = {
	custom_effect_tooltip = BAR_resources_gain_leopold_1000
	add_to_variable = {
		var = BAR_resources_leopold
		value = 1000
	}
}
BAR_resources_add_viira_250 = {
	custom_effect_tooltip = BAR_resources_gain_viira_250
	add_to_variable = {
		var = BAR_resources_viira
		value = 250
	}
}
BAR_resources_add_viira_500 = {
	custom_effect_tooltip = BAR_resources_gain_viira_500
	add_to_variable = {
		var = BAR_resources_viira
		value = 500
	}
}
BAR_resources_add_viira_750 = {
	custom_effect_tooltip = BAR_resources_gain_viira_750
	add_to_variable = {
		var = BAR_resources_viira
		value = 750
	}
}
BAR_resources_add_viira_1000 = {
	custom_effect_tooltip = BAR_resources_gain_viira_1000
	add_to_variable = {
		var = BAR_resources_viira
		value = 1000
	}
}

### subtract resources ###

BAR_resources_subtract_asinti_1500 = {
	if = {
		limit = {
			has_country_flag = BAR_asinti_discount
		}
		custom_effect_tooltip = BAR_resources_substract_asinti_1350
		subtract_from_variable = {
			var = BAR_resources_asinti
			value = 900
		}
	}
	else = {
		custom_effect_tooltip = BAR_resources_substract_asinti_1500
		subtract_from_variable = {
			var = BAR_resources_asinti
			value = 1500
		}
	}	
}
BAR_resources_subtract_asinti_500 = {
	if = {
		limit = {
			has_country_flag = BAR_asinti_discount
		}
		custom_effect_tooltip = BAR_resources_substract_asinti_300
		subtract_from_variable = {
			var = BAR_resources_asinti
			value = 300
		}
	}
	else = {
		custom_effect_tooltip = BAR_resources_substract_asinti_500
		subtract_from_variable = {
			var = BAR_resources_asinti
			value = 500
		}
	}	
}
BAR_resources_subtract_asinti_750 = {
	if = {
		limit = {
			has_country_flag = BAR_asinti_discount
		}
		custom_effect_tooltip = BAR_resources_substract_asinti_450
		subtract_from_variable = {
			var = BAR_resources_asinti
			value = 450
		}
	}
	else = {
		custom_effect_tooltip = BAR_resources_substract_asinti_750
		subtract_from_variable = {
			var = BAR_resources_asinti
			value = 750
		}
	}
}
BAR_resources_subtract_asinti_1000 = {
	if = {
		limit = {
			has_country_flag = BAR_asinti_discount
		}
		custom_effect_tooltip = BAR_resources_substract_asinti_600
		subtract_from_variable = {
			var = BAR_resources_asinti
			value = 600
		}
	}
	else = {
		custom_effect_tooltip = BAR_resources_substract_asinti_1000
		subtract_from_variable = {
			var = BAR_resources_asinti
			value = 1000
		}
	}
}
BAR_resources_subtract_silver_1500 = {
	custom_effect_tooltip = BAR_resources_substract_silver_1500
	subtract_from_variable = {
		var = BAR_resources_silver
		value = 1500
	}
}
BAR_resources_subtract_silver_500 = {
	custom_effect_tooltip = BAR_resources_substract_silver_500
	subtract_from_variable = {
		var = BAR_resources_silver
		value = 500
	}
}
BAR_resources_subtract_silver_750 = {
	custom_effect_tooltip = BAR_resources_substract_silver_750
	subtract_from_variable = {
		var = BAR_resources_silver
		value = 750
	}
}
BAR_resources_subtract_silver_1000 = {
	custom_effect_tooltip = BAR_resources_substract_silver_1000
	subtract_from_variable = {
		var = BAR_resources_silver
		value = 1000
	}
}
BAR_resources_subtract_leopold_1500 = {
	custom_effect_tooltip = BAR_resources_substract_leopold_1500
	subtract_from_variable = {
		var = BAR_resources_leopold
		value = 1500
	}
}
BAR_resources_subtract_leopold_500 = {
	custom_effect_tooltip = BAR_resources_substract_leopold_500
	subtract_from_variable = {
		var = BAR_resources_leopold
		value = 500
	}
}
BAR_resources_subtract_leopold_750 = {
	custom_effect_tooltip = BAR_resources_substract_leopold_750
	subtract_from_variable = {
		var = BAR_resources_leopold
		value = 750
	}
}
BAR_resources_subtract_leopold_1000 = {
	custom_effect_tooltip = BAR_resources_substract_leopold_1000
	subtract_from_variable = {
		var = BAR_resources_leopold
		value = 1000
	}
}
BAR_resources_subtract_viira_1500 = {
	custom_effect_tooltip = BAR_resources_substract_viira_1500
	subtract_from_variable = {
		var = BAR_resources_viira
		value = 1500
	}
}
BAR_resources_subtract_viira_500 = {
	custom_effect_tooltip = BAR_resources_substract_viira_500
	subtract_from_variable = {
		var = BAR_resources_viira
		value = 500
	}
}
BAR_resources_subtract_viira_750 = {
	custom_effect_tooltip = BAR_resources_substract_viira_750
	subtract_from_variable = {
		var = BAR_resources_viira
		value = 750
	}
}
BAR_resources_subtract_viira_1000 = {
	custom_effect_tooltip = BAR_resources_substract_viira_1000
	subtract_from_variable = {
		var = BAR_resources_viira
		value = 1000
	}
}

### relations ###

BAR_relations_increase_asinti_silver_5 = {
	custom_effect_tooltip = BAR_relations_increase_asinti_silver
	if = {
		limit = {
			check_variable = {
				var = BAR_relations_asinti_silver
				value = 95
				compare = less_than_or_equals
			}
		}
		add_to_variable = {
			var = BAR_relations_asinti_silver
			value = 5
		}
	}
	else = {
		set_variable = { BAR_relations_asinti_silver = 100 }
	}
	BAR_relations_idea_swap = yes
}
BAR_relations_increase_asinti_leopold_5 = {
	custom_effect_tooltip = BAR_relations_increase_asinti_leopold
	if = {
		limit = {
			check_variable = {
				var = BAR_relations_asinti_leopold
				value = 95
				compare = less_than_or_equals
			}
		}
		add_to_variable = {
			var = BAR_relations_asinti_leopold
			value = 5
		}
	}
	else = {
		set_variable = { BAR_relations_asinti_leopold = 100 }
	}
	BAR_relations_idea_swap = yes
}
BAR_relations_increase_asinti_viira_5 = {
	custom_effect_tooltip = BAR_relations_increase_asinti_viira
	if = {
		limit = {
			check_variable = {
				var = BAR_relations_asinti_viira
				value = 95
				compare = less_than_or_equals
			}
		}
		add_to_variable = {
			var = BAR_relations_asinti_viira
			value = 5
		}
	}	
	else = {
		set_variable = { BAR_relations_asinti_viira = 100 }
	}
	BAR_relations_idea_swap = yes
}
BAR_relations_increase_silver_leopold_5 = {
	custom_effect_tooltip = BAR_relations_increase_silver_leopold
	if = {
		limit = {
			check_variable = {
				var = BAR_relations_silver_leopold
				value = 95
				compare = less_than_or_equals
			}
		}
		add_to_variable = {
			var = BAR_relations_silver_leopold
			value = 5
		}
	}
	else = {
		set_variable = { BAR_relations_silver_leopold = 100 }
	}
	BAR_relations_idea_swap = yes
}
BAR_relations_increase_silver_viira_5 = {
	custom_effect_tooltip = BAR_relations_increase_silver_viira
	if = {
		limit = {
			check_variable = {
				var = BAR_relations_silver_viira
				value = 95
				compare = less_than_or_equals
			}
		}
		add_to_variable = {
			var = BAR_relations_silver_viira
			value = 5
		}
	}
	else = {
		set_variable = { BAR_relations_silver_viira = 100 }
	}
	BAR_relations_idea_swap = yes
}
BAR_relations_increase_leopold_viira_5 = {
	custom_effect_tooltip = BAR_relations_increase_leopold_viira
	if = {
		limit = {
			check_variable = {
				var = BAR_relations_leopold_viira
				value = 95
				compare = less_than_or_equals
			}
		}
		add_to_variable = {
			var = BAR_relations_leopold_viira
			value = 5
		}
	}
	else = {
		set_variable = { BAR_relations_leopold_viira = 100 }
	}
	BAR_relations_idea_swap = yes
}

BAR_relations_decrease_asinti_silver_5 = {
	custom_effect_tooltip = BAR_relations_decrease_asinti_silver
	if = {
		limit = {
			has_country_flag = barrad_early_game
			has_country_flag = BAR_silver_sad
			check_variable = { BAR_relations_asinti_silver > 69 }
		}
		set_country_flag = BAR_silver_trig_event
	}
	if = {
		limit = {
			check_variable = {
				var = BAR_relations_asinti_silver
				value = 5
				compare = greater_than_or_equals
			}
		}
		subtract_from_variable = {
			var = BAR_relations_asinti_silver
			value = 5
		}
	}
	else = {
		set_variable = { BAR_relations_asinti_silver = 0 }
	}
	if = {
		limit = {
			has_country_flag = BAR_silver_trig_event
			check_variable = { BAR_relations_asinti_silver < 70 }
		}
		clr_country_flag = BAR_silver_sad
	}
	BAR_relations_idea_swap = yes
}
BAR_relations_decrease_asinti_leopold_5 = {
	custom_effect_tooltip = BAR_relations_decrease_asinti_leopold
	if = {
		limit = {
			check_variable = {
				var = BAR_relations_asinti_leopold
				value = 5
				compare = greater_than_or_equals
			}
		}
		subtract_from_variable = {
			var = BAR_relations_asinti_leopold
			value = 5
		}
	}	
	else = {
		set_variable = { BAR_relations_asinti_leopold = 0 }
	}
	BAR_relations_idea_swap = yes
}
BAR_relations_decrease_asinti_viira_5 = {
	custom_effect_tooltip = BAR_relations_decrease_asinti_viira
	if = {
		limit = {
			check_variable = {
				var = BAR_relations_asinti_viira
				value = 5
				compare = greater_than_or_equals
			}
		}
		subtract_from_variable = {
			var = BAR_relations_asinti_viira
			value = 5
		}
	}
	else = {
		set_variable = { BAR_relations_asinti_viira = 0 }
	}
	BAR_relations_idea_swap = yes
}
BAR_relations_decrease_silver_leopold_5 = {
	if = {
		limit = {
			has_country_flag = barrad_early_game
			has_country_flag = BAR_silver_sad
			check_variable = { BAR_relations_silver_leopold > 69 }
		}
		set_country_flag = BAR_silver_trig_event
	}
	custom_effect_tooltip = BAR_relations_decrease_silver_leopold
	if = {
		limit = {
			check_variable = {
				var = BAR_relations_silver_leopold
				value = 5
				compare = greater_than_or_equals
			}
		}
		subtract_from_variable = {
			var = BAR_relations_silver_leopold
			value = 5
		}
	}
	else = {
		set_variable = { BAR_relations_silver_leopold = 0 }
	}
	if = {
		limit = {
			has_country_flag = BAR_silver_trig_event
			check_variable = { BAR_relations_silver_leopold < 70 }
		}
		clr_country_flag = BAR_silver_sad
	}
	BAR_relations_idea_swap = yes
}
BAR_relations_decrease_silver_viira_5 = {
	if = {
		limit = {
			has_country_flag = barrad_early_game
			has_country_flag = BAR_silver_sad
			check_variable = { BAR_relations_silver_viira > 69 }
		}
		set_country_flag = BAR_silver_trig_event
	}
	custom_effect_tooltip = BAR_relations_decrease_silver_viira
	if = {
		limit = {
			check_variable = {
				var = BAR_relations_silver_viira
				value = 5
				compare = greater_than_or_equals
			}
		}
		subtract_from_variable = {
			var = BAR_relations_silver_viira
			value = 5
		}
	}	
	else = {
		set_variable = { BAR_relations_silver_viira = 0 }
	}
	if = {
		limit = {
			has_country_flag = BAR_silver_trig_event
			check_variable = { BAR_relations_silver_viira < 70 }
		}
		clr_country_flag = BAR_silver_sad
	}
	BAR_relations_idea_swap = yes
}
BAR_relations_decrease_leopold_viira_5 = {
	custom_effect_tooltip = BAR_relations_decrease_leopold_viira
	if = {
		limit = {
			check_variable = {
				var = BAR_relations_leopold_viira
				value = 5
				compare = greater_than_or_equals
			}
		}
		subtract_from_variable = {
			var = BAR_relations_leopold_viira
			value = 5
		}
	}
	else = {
		set_variable = { BAR_relations_leopold_viira = 0 }
	}
	BAR_relations_idea_swap = yes
}

BAR_population_convert = {
	THIS = {
		set_state_category = rural
		#half od the factories are added to barrad capital
		set_temp_variable = { armsFactories = arms_factory_level }
		set_temp_variable = { civFactories = industrial_complex_level }
		divide_temp_variable = { armsFactories = 2 }
		divide_temp_variable = { civFactories = 2 }
		round_variable = armsFactories
		round_variable = civFactories
		
		626 = {
			if = {
				limit = {
					check_variable = { armsFactories > 0 }
				}
				add_extra_state_shared_building_slots = armsFactories
				add_building_construction = {
					type = arms_factory
					level = armsFactories
					instant_build = yes
				}
			}	
			if = {
				limit = {
					check_variable = { civFactories > 0 }
				}
				add_extra_state_shared_building_slots = industrial_complex_level
				add_building_construction = {
					type = industrial_complex
					level = civFactories
					instant_build = yes
				}
			}
		}

		set_building_level = {
			type = arms_factory
			level = 0
			instant_build = yes
		}
		set_building_level = {
			type = industrial_complex
			level = 0
			instant_build = yes
		}
	}

	add_compliance = 100

	hidden_effect = {
		set_temp_variable = { popToAdd = state_population }
		multiply_temp_variable = { popToAdd = 0.4 }

		save_current_manpower = yes
		while_loop_effect = {
			limit = {
				THIS = {
					state_population > 900000
				}
			}
			THiS = {
				add_manpower = -900000
			}
		}
		THiS = {
			set_temp_variable = { popToKill = state_population }
			multiply_temp_variable = { popToKill = -1 }
			add_manpower = -popToKill
		}

		restore_previous_manpower = yes
		ROOT = {
			add_manpower = popToAdd
		}
	}
	custom_effect_tooltip = bar_convert_population_manpower_tooltip
}
BAR_un_idea_buffs_remove = {
	hidden_effect = {
		clr_country_flag = BAR_un_buff_piercing_flag
		clr_country_flag = BAR_un_buff_org_flag
		clr_country_flag = BAR_un_buff_break_flag
		clr_country_flag = BAR_un_buff_def_flag
		clr_country_flag = BAR_un_buff_attack_flag
		set_technology = {
			popup = no
			BAR_un_buff_piercing_tech = 0
		}
		set_technology = {
			popup = no
			BAR_un_buff_org_tech = 0
		}
		set_technology = {
			popup = no
			BAR_un_buff_break_tech = 0
		}
		set_technology = {
			popup = no
			BAR_un_buff_def_tech = 0
		}
		set_technology = {
			popup = no
			BAR_un_buff_attack_tech = 0
		}
	}	
}
barrad_kill_leopold = {
	hidden_effect = {
		clr_country_flag = barrad_leopold_alive
		if = {
			limit = {
				has_variable = bar_pen_screen_show
			}
			bar_gui_update = yes
		}
		if = {
			limit = {
				has_character = BAR_leopold_schmeller
			}
			BAR_leopold_schmeller = {
				retire = yes
			}
		}
		set_technology = {
			popup = no
			barrad_leopold_alive = 0
		}
		clear_variable = BAR_resources_leopold
		if = {
			limit = {
				624 = {
					is_owned_by = BAR
				}
			}
			set_province_name = {
				id = 4557
				name = BAR_beorgham
			}
		}
		remove_ideas = BAR_relations_asinti_leopold_negative
		remove_ideas = BAR_relations_asinti_leopold_positive
		remove_ideas = BAR_relations_leopold_viira_negative
		remove_ideas = BAR_relations_leopold_viira_positive
		remove_ideas = BAR_relations_silver_leopold_negative
		remove_ideas = BAR_relations_silver_leopold_positive
		add_popularity = {
			ideology = fascism
			popularity = -0.10
		}
		BAR_pentarchy_is_dead = yes
	}
}
barrad_kill_asinti = {
	hidden_effect = {
		clr_country_flag = barrad_asinti_alive
		if = {
			limit = {
				has_variable = bar_pen_screen_show
			}
			bar_gui_update = yes
		}
		if = {
			limit = {
				has_character = BAR_asinti
			}
			BAR_asinti = {
				retire = yes
			}
		}
		set_technology = {
			popup = no
			barrad_asinti_alive = 0
		}
		clear_variable = BAR_resources_asinti
		if = {
			limit = {
				625 = {
					is_owned_by = BAR
				}
			}
			set_province_name = {
				id = 4516
				name = BAR_grenbridge
			}
		}
		remove_ideas = BAR_relations_asinti_leopold_negative
		remove_ideas = BAR_relations_asinti_leopold_positive
		remove_ideas = BAR_relations_asinti_viira_negative
		remove_ideas = BAR_relations_asinti_viira_positive
		remove_ideas = BAR_relations_asinti_silver_negative
		remove_ideas = BAR_relations_asinti_silver_positive
		add_popularity = {
			ideology = fascism
			popularity = -0.10
		}
		BAR_pentarchy_is_dead = yes
	}
}
barrad_kill_silver = {
	hidden_effect = {
		clr_country_flag = barrad_silver_star_alive
		if = {
			limit = {
				has_variable = bar_pen_screen_show
			}
			bar_gui_update = yes
		}
		if = {
			limit = {
				has_character = BAR_silver_star
			}
			BAR_silver_star = {
				retire = yes
			}
		}
		set_technology = {
			popup = no
			barrad_silver_star_alive = 0
		}
		clear_variable = BAR_resources_silver
		remove_ideas = BAR_relations_silver_leopold_negative
		remove_ideas = BAR_relations_silver_leopold_positive
		remove_ideas = BAR_relations_silver_viira_negative
		remove_ideas = BAR_relations_silver_viira_positive
		remove_ideas = BAR_relations_asinti_silver_negative
		remove_ideas = BAR_relations_asinti_silver_positive
		add_popularity = {
			ideology = fascism
			popularity = -0.10
		}
		BAR_pentarchy_is_dead = yes
	}	
}
barrad_kill_viira = {
	hidden_effect = {
		clr_country_flag = barrad_viira_alive
		if = {
			limit = {
				has_variable = bar_pen_screen_show
			}
			bar_gui_update = yes
		}
		if = {
			limit = {
				has_character = BAR_viira_lehtola
			}
			BAR_viira_lehtola = {
				retire = yes
			}
		}
		set_technology = {
			popup = no
			barrad_viira_alive = 0
		}
		clear_variable = BAR_resources_viira
		if = {
			limit = {
				625 = {
					is_owned_by = BAR
				}
			}
			set_province_name = {
				id = 4910
				name = BAR_axford
			}
		}
		remove_ideas = BAR_relations_leopold_viira_negative
		remove_ideas = BAR_relations_leopold_viira_positive
		remove_ideas = BAR_relations_silver_viira_negative
		remove_ideas = BAR_relations_silver_viira_positive
		remove_ideas = BAR_relations_asinti_viira_negative
		remove_ideas = BAR_relations_asinti_viira_positive
		add_popularity = {
			ideology = fascism
			popularity = -0.10
		}
		BAR_pentarchy_is_dead = yes
	}
}
change_all_province_names = {
	hidden_effect = {
		set_province_name = {
			id = 4516
			name = BAR_grenbridge
		}
		set_province_name = {
			id = 4910
			name = BAR_axford
		}
		set_province_name = {
			id = 4557
			name = BAR_beorgham
		}
		set_province_name = {
			id = 12307
			name = BAR_elysium
		}
	}	
}
bar_viira_spells_max_overload = {
	hidden_effect = {
		if = {
			limit = {
				has_variable = BAR_viira_godhood
			}

			set_temp_variable = { viira_max_overload = 0 }
			every_owned_state = {
				add_to_temp_variable = { viira_max_overload = building_level@nuclear_reactor }
			}
			multiply_variable = { viira_max_overload = 100 } 

			if = {
				limit = {
					check_variable = {
						viira_mana_overload > viira_max_overload
					}
				}
				
				country_event = { id = barrad_viira.997 }
			}

			if = {
				limit = {
					check_variable = { viira_mana_overload = 0 } 
				}
				set_variable = { viira_mana_overload_percentage = 0 }
			} else = {
				set_variable = { viira_mana_overload_percentage = viira_mana_overload }
				divide_variable = { viira_mana_overload_percentage = viira_max_overload }
				multiply_variable = { viira_mana_overload_percentage = 100 }
				round_variable = viira_mana_overload_percentage
			}
		}
	}	
}
bar_viira_spells_overload_monthly_tickdown = {
	set_temp_variable = { viira_mana_tickdown = 0 }
	every_owned_state = {
		add_to_temp_variable = { viira_mana_tickdown = building_level@nuclear_reactor }
	}
	multiply_variable = { viira_mana_tickdown = 9 } 
	subtract_from_variable = { viira_mana_overload = viira_mana_tickdown }

	if = {
		limit = {
			check_variable = { viira_mana_overload < 0 }
		}
		set_variable = { viira_mana_overload = 0 }
	}
}
one_state_inf = {
	if = {
		limit = {
			infrastructure < 10
		}
		add_building_construction = { 
			type = infrastructure
			level = 1
			instant_build = yes 
		}
	}
	else = {
		add_extra_state_shared_building_slots = 1
	}
}
BAR_clear_mess_puppet = {
	hidden_effect = {
		set_country_flag = BAR_end_of_pentarchy
		clr_country_flag = BAR_undead_convert
		clr_country_flag = barrad_early_game
		clr_country_flag = BAR_asinti_kill_count
		clear_variable = BAR_viira_pup
		clear_variable = BAR_viira_godhood
		remove_ideas = BAR_blood_curse_idea
		remove_ideas = BAR_pentarchy
		remove_ideas = BAR_pentarchy_enemy
		remove_ideas = BAR_pentarchy_concern
		if = {
			limit = {
				has_template = "Leopold Schmeller"
			}
			delete_unit_template_and_units = {
				division_template = "Leopold Schmeller"
				disband = no
			}
			add_equipment_to_stockpile = {
				type = bar_leopold_equipment_1
				amount = -1000
			}
		}
		set_technology = {
			bar_leopold_new_body = 0
		}
		set_technology = {
			BAR_clockwerks = 0
		}
		set_technology = {
			BAR_clockwerks_upgrade = 0
		}
		add_country_leader_role = {
			character = BAR_angry_mob
			promote_leader = yes

			country_leader = {
				expire = "1965.1.1"
				ideology = falangism
			}
		}
		every_character = {
			remove_unit_leader_role = yes
		}
		load_focus_tree = generic_griffon_focus
		add_ideas = poverty1
		add_ideas = lack_of_scientists2
		add_ideas = limited_conscription
		add_ideas = civilian_economy
		change_all_province_names = yes
		drop_cosmetic_tag = yes
	}
}

BAR_new_viira_note = {
	hidden_effect = {
		ROOT = {
			set_variable = { BAR_new_journal_entry_trigger = 1 }
			country_event = { id = bar_clear_journal.1 hours = 6 }
		}	
	}
}

BAR_gui_reset = {
	if = {
		limit = {
			has_country_flag = barrad_leopold_alive
		}
		set_variable = {
			bar_leopold_state = 2
		}
	}
	else = {
		set_variable = {
			bar_leopold_state = 4
		}
	}
	if = {
		limit = {
			OR = {
				has_country_flag = BAR_advisors_killed
				has_country_flag = BAR_ambrosius_killed
			}
		}
		set_variable = {
			bar_ambrosius_state = 4
		}
	}
	else = {
		set_variable = {
			bar_ambrosius_state = 2
		}
	}
	if = {
		limit = {
			has_country_flag = barrad_silver_star_alive
		}
		set_variable = {
			bar_silver_state = 2
		}
	}
	else = {
		set_variable = {
			bar_silver_state = 4
		}
	}
	if = {
		limit = {
			has_country_flag = barrad_asinti_alive
		}
		set_variable = {
			bar_asinti_state = 2
		}
	}
	else = {
		set_variable = {
			bar_asinti_state = 4
		}
	}
	if = {
		limit = {
			has_country_flag = barrad_viira_alive
		}
		set_variable = {
			bar_viira_state = 2
		}
	}
	else = {
		set_variable = {
			bar_viira_state = 4
		}
	}
}
bar_gui_update = {
	add_to_variable = { bar_pen_screen_show = 1 }
	if = {
		limit = {
			OR = {
				has_country_flag = BAR_advisors_killed
				has_country_flag = BAR_ambrosius_killed
			}
			check_variable = { bar_ambrosius_state < 3 }
		}
		add_to_variable = { bar_ambrosius_state = 2}
	}
	if = {
		limit = {
			NOT = { has_country_flag = barrad_leopold_alive }
			check_variable = { bar_leopold_state < 3 }
		}
		add_to_variable = { bar_leopold_state = 2}
	}
	if = {
		limit = {
			NOT = { has_country_flag = barrad_silver_star_alive }
			check_variable = { bar_silver_state < 3 }
		}
		add_to_variable = { bar_silver_state = 2}
	}
	if = {
		limit = {
			NOT = { has_country_flag = barrad_asinti_alive }
			check_variable = { bar_asinti_state < 3 }
		}
		add_to_variable = { bar_asinti_state = 2}
	}
	if = {
		limit = {
			NOT = { has_country_flag = barrad_viira_alive }
			check_variable = { bar_viira_state < 3 }
		}
		add_to_variable = { bar_viira_state = 2}
	}
}

bar_kill_ambrosius = {
	if = {
		limit = {
			has_variable = bar_pen_screen_show
		}
		bar_gui_update = yes
	}
	if = {
		limit = {
			has_character = BAR_count_ambrosius
		}
		BAR_count_ambrosius = {
			retire = yes
		}
	}
	set_country_flag = BAR_ambrosius_killed
}

bar_kill_advisors = {
	if = {
		limit = {
			has_variable = bar_pen_screen_show
		}
		bar_gui_update = yes
	}
	set_country_flag = BAR_advisors_killed
	BAR_leofric_and_godgifu_glaedwine = {
		set_character_name = BAR_ded_scientist
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor2
			}
		}
	}
	BAR_aethelflaed_sigeweard = {
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor2
			}
		}
	}
	BAR_hereweald_ealdwine = {
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor2
			}
		}
	}
	BAR_eadmund_heahstan = {
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor2
			}
		}
	}
	BAR_sabedoria = {
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor2
			}
		}
	}
	BAR_oswine_sigespere = {
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor2
			}
		}
	}
	BAR_mister_lilly = {
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor2
			}
		}
	}
	BAR_leofric_stearcstan = {
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor
			}
		}
	}
	BAR_beorhtsige_sigespere = {
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor
			}
		}
	}
	BAR_ceadda_sigeweald = {
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor
			}
		}
	}
	BAR_godric_hereweald = {
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor
			}
		}
	}
	BAR_wigmund_sunnespere = {
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor
			}
		}
	}
	BAR_stithulf_frostdun = {
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor
			}
		}
	}
	BAR_hrothgar_fiscford = {
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor
			}
		}
	}
	BAR_wilfrith_faegerwell = {
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor
			}
		}
	}
	BAR_cyneweard_stangaet = {
		set_portraits = {
			army = {
				small=GFX_idea_BAR_undead_advisor
			}
		}
	}
}

BAR_remove_cooperation = {
	remove_ideas = BAR_relations_asinti_silver_positive
	remove_ideas = BAR_relations_asinti_leopold_positive
	remove_ideas = BAR_relations_asinti_viira_positive
	remove_ideas = BAR_relations_silver_leopold_positive
	remove_ideas = BAR_relations_silver_viira_positive
	remove_ideas = BAR_relations_leopold_viira_positive
	remove_ideas = BAR_relations_asinti_silver_negative
	remove_ideas = BAR_relations_asinti_leopold_negative
	remove_ideas = BAR_relations_asinti_viira_negative
	remove_ideas = BAR_relations_silver_leopold_negative
	remove_ideas = BAR_relations_silver_viira_negative
	remove_ideas = BAR_relations_leopold_viira_negative
}

BAR_spell_upgrades_prepare = {
	resize_array = {
		array = bar_viira_mana_crystal_array
		value = 1
		size = 16
	}

	for_loop_effect = {
		start = 0
		end = 15
		value = reactor_index
		meta_effect = {
			text = {
				if = {
					limit = {
						nuclear_reactor > reactor_index
					}
					set_variable = {
						bar_viira_mana_crystal_array^reactor_index = 2
					}
				}
				else = {
					set_variable = {
						bar_viira_mana_crystal_array^reactor_index = 1
					}
				}
			}
			REACTOR_REQUIRED_COUNT = "[?reactor_index]"
		}
	}
}

BAR_unlock_spells_1 = {
	#mass migration
	country_event = { id = barrad_viira.23 }
	set_country_flag = BAR_spells_unlocked_1
}
BAR_unlock_spells_2 = {
	#research bonuses
	country_event = { id = barrad_viira.22 }
	set_country_flag = BAR_spells_unlocked_2
}
BAR_unlock_spells_3 = {
	#stronger spells
	country_event = { id = barrad_viira.21 }
	set_country_flag = BAR_spells_unlocked_3
}
BAR_unlock_spells_4 = {
	#psi powers upgrade
	country_event = { id = barrad_viira.20 }
	set_country_flag = BAR_spells_unlocked_4
}
BAR_unlock_spells_5 = {
	#conjure buildings
	country_event = { id = barrad_viira.19 }
	set_country_flag = BAR_spells_unlocked_5
}
BAR_unlock_spells_6 = {
	#mind control perfection
	country_event = { id = barrad_viira.18 }
	set_country_flag = BAR_spells_unlocked_6
}
BAR_unlock_spells_7 = {
	#conjure resources
	country_event = { id = barrad_viira.17 }
}
BAR_unlock_spells_8 = {
	country_event = { id = barrad_viira.16 }
}
BAR_add_gasienica_as_commander  = {
	add_corps_commander_role = {
		character = BAR_captain_gasienica
		traits = {
			griffon_race_trait
			bar_cpt_gasienica
			trait_mountaineer
			infantry_officer
			trickster
		}
		skill = 5
		attack_skill = 5
		defense_skill = 3
		planning_skill = 3
		logistics_skill = 5
		legacy_id = 997003
	}
}